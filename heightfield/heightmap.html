<html>

<head>
	<!-- Style -->
	<link rel="stylesheet" type="text/css" media="all" href="styles.css"/>
	<!-- Scripts -->
	<script type="text/javascript" src="xml3d-dev.js"></script>
	<script type="text/javascript" src="camera.js"></script>
	<script type="text/javascript" src="myxflow.js"></script>
	<title>Heightfield Examples</title>
	<script type="text/javascript">
		window.addEventListener("load", function() {
			var viewElem = document.getElementById("Camera");
			window.DemoCamera = new XML3D.StandardCamera(viewElem, {
				mode:"examine"
			});

			XML3D.options.setValue("renderer-faceculling", "back");
		});
	</script>
</head>

<body>
<div id="container">
<xml3d id="myxml3d" class="xml3d" view="#Camera" style="width: 100%; height: 100%;">

	<material id="Material" model="urn:xml3d:material:phong">
		<float name="ambientIntensity">0.4</float>
		<float3 name="diffuseColor">0.6 0.6 0.6</float3>
		<float3 name="specularColor">0.8 0.8 0.8</float3>
		<float name="shininess">0.978473581213</float>
	</material>

	<!-- Load terrain data: -->
	<data id="terrain_data" compute="dimensions = xflow.imagesize(heightmap)">
		<data compute="elevation = xflow.elevation(heightmap)">
			<texture name="heightmap">
				<img src="YukonHeightField2.png">
			</texture>
		</data>
	</data>

	<!-- Generate Grid: -->    
	<data id="generatedGrid" compute="xflow.mygrid()">
		<data src="#terrain_data" filter="rename({size: dimensions})"></data>
		<string name="type">tristrips</string>
	</data>

	<!-- Transform Grid by elevation data: -->
	<data id="surface" compute="xflow.vertexNormal()">
		<data id="displace" compute="position = xflow.morph(position, scale, elevation)">
			<float3 name="scale" id="scale">0 0.4 0</float3>
			<data src="#generatedGrid"></data>
		</data>
	</data>

	<transform id="t_Camera" translation="29.752 14.970 31.171" rotation="-0.394 0.910 0.131 0.826"></transform>
	<view id="Camera" transform="#t_Camera"></view>
	
	<group material="#Material" style="transform: scale3d(25, 25, 25);">
		<mesh type="#surface">
			<data src="#surface"></data>
		</mesh>
	</group>

	<!-- Light Source: -->     
	<group style="transform: translate3d(2.09px, 10.65px, 1.16px) rotate3d(0.206, 0.332, 0.921, 1.926rad);">
		<light model="urn:xml3d:light:directional">
			<!-- <float3 name="attenuation">1 0.033333 1</float3> -->
			<float3 name="intensity">1 1 1</float3>
		</light>
	</group>

</xml3d>
</div>
</body>

</html>